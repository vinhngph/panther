!function(){"use strict";const e=async e=>{const t=Array.from(e.querySelectorAll("img")).map(e=>e.complete?Promise.resolve():new Promise(t=>{const n=()=>{e.removeEventListener("load",n),e.removeEventListener("error",n),t()};e.addEventListener("load",n,{once:!0}),e.addEventListener("error",n,{once:!0})}));await Promise.all([...t]),await new Promise(requestAnimationFrame)};const t=e=>{const t=document.createElement("div");return Object.assign(t.style,{fontFamily:"sans-serif",position:"fixed",top:"20px",right:"20px",backgroundColor:"#FF5722",color:"white",padding:"15px",borderRadius:"5px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",opacity:"1",transition:"opacity 0.5s ease",fontSize:"20px",zIndex:"9999"}),document.body.appendChild(t),{setProgress:n=>{if(n===e)return t.remove();t.textContent=`Scanning: ${n}/${e}`}}},n=e=>{const t=document.getElementById("page-container-wrapper")?.childNodes[0]?.childNodes[1]?.childNodes[0];if(!t)return;const n=e=>{const t=document.createElement("div");t.style.width="100mm",t.style.position="absolute",t.style.visibility="hidden",document.body.appendChild(t);const n=100/t.getBoundingClientRect().width;return document.body.removeChild(t),e*n},o=e=>{const t=document.createElement("div");t.style.width="100mm",t.style.position="absolute",t.style.visibility="hidden",document.body.appendChild(t);const n=t.getBoundingClientRect().width/100;return document.body.removeChild(t),e*n},r=n(t.clientWidth),i=n(t.clientHeight),s=r<i?"portrait":"landscape",[l,d,c]=(e=>{const t=e.split(".");return 5===t.length?[t[0],Number(t[1]+"."+t[2]),Number(t[3]+"."+t[4])]:3===t.length?[t[0],Number(t[1]),Number(t[2])]:null})(e);let a,m,u;"portrait"==s?(a=Math.min(d/r,c/i),m=o((d-r*a)/2),u=o((c-i*a)/2)):(a=Math.min(c/r,d/i),m=o((c-r*a)/2),u=o((d-i*a)/2));const p=document.createElement("style");return p.innerText=`@media print { @page { size: ${l} ${s}; margin: 0; } #page-container { transform: scale(${a}) translate(${m}px, ${u}px); transform-origin: top left; }}`,p},o=()=>{const e=document.getElementById("page-container-wrapper")?.cloneNode(!0);if(e)return e.style=null,e.querySelectorAll('[class*="banner-wrapper"]').forEach(e=>{e&&e.remove()}),e.childNodes[0].childNodes.forEach(e=>{if(2==e.childNodes.length)return e.childNodes[1].style="display: block",void(e.childNodes[1].childNodes[0].style="display: block");e.childNodes[0].style="display: block",e.childNodes[0].childNodes[0].style="display: block;"}),e;alert("Error: Clone document")};async function r(){if(!(()=>{let e=document.querySelectorAll("button");return 0===Array.from(e).filter(e=>Array.from(e.classList).some(e=>e.startsWith("PremiumBannerButton"))).length})()&&confirm('Advertisement banners are detected in this document.\nClick "OK" to remove them and refresh the page.\nClick "Cancel" if you believe all banners have been removed.'))return location.reload();const r=await(async()=>new Promise(e=>{const t=document.createElement("iframe");function n(n){n.source===t.contentWindow&&("cancelled"===n.data?.type&&(o(),e(null)),"confirmed"===n.data?.type&&(o(),e(n.data.value)))}function o(){window.removeEventListener("message",n),t.remove()}t.src=chrome.runtime.getURL("src/assets/modals/papersize.html"),t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.pointerEvents="auto",t.style.zIndex="9999",t.style.opacity="0",t.style.transition="opacity 0.3s ease",document.body.appendChild(t),requestAnimationFrame(()=>{t.style.opacity="1"}),window.addEventListener("message",n)}))();if(r){if(!(()=>{let e=[];const t=document.getElementById("page-container")?.childNodes;for(const n of t)"page-content"===n?.childNodes[0]?.childNodes[0]?.className&&2!==n?.childNodes[0]?.childNodes[0]?.childNodes.length&&e.push(n);return 0===e.length})()){const n=window.scrollY;await async function(){const n=document.getElementById("page-container");if(!n)return void alert("Page container element not found");const o=Array.from(n.childNodes),r=t(o.length);for(let t=0;t<o.length;t++)try{o[t].scrollIntoView({behavior:"instant",block:"start"}),r.setProgress(t+1),await e(o[t])}catch(i){return void alert("Error processing element:",i)}}(),await(async e=>new Promise(t=>{const n=()=>{window.scrollY===e&&(window.removeEventListener("scroll",n),t())};window.scrollTo({top:e,behavior:"smooth"}),window.addEventListener("scroll",n)}))(n)}return(async e=>{const t=(document.querySelector('link[rel="stylesheet"][href*="doc-assets"][href*=".studocu.com"]')||document.querySelector('link[as="style"][href*="doc-assets"][href*=".studocu.com"]'))?.cloneNode(!0),r=window.open("");r.document.title=document.title,r.document.head.appendChild(t),r.document.head.appendChild(n(e)),r.document.body.appendChild(o());const i=r.document.createElement("script");i.src=chrome.runtime.getURL("src/bundle/viewer.bundle.js"),r.document.body.appendChild(i)})(r)}}(async()=>{document.querySelectorAll('[aria-label="Download"]').forEach(e=>{e&&(e.onclick=null,e.addEventListener("click",async e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation(),r()},!0))})})()}();
